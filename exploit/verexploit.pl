#start checking 3.8.6 DataBase information leak vuln
if($ver =~ m/3\.8\.6/i){
    print color("yellow");
    tprint("vBulletin 3.8.6 faq.php Information Disclosure vulnerability \n EDB : https://www.exploit-db.com/exploits/14455/");
    $source=$ua->get("$target/faq.php?s=&do=search&q=Database&match=all&titlesonly=0")->decoded_content;
    if($source =~ m/Host/i and $source =~ m/Port/i){
        tprint("faq.php is vulnerable\n DataBase configuration path : $target/faq.php?s=&do=search&q=Database&match=all&titlesonly=0");
    }else{
        fprint("faq.php is not vulnerable");
    }
}
#end checking 3.8.6 DataBase information leak vuln


open(my $DB,"exploit/vbscandb.txt");
my $vver=substr($ver, index($ver, ' ')+1, 6);
$vver =~ s/ //g;
while( my $row = <$DB>)  {
    chomp $row;
    my $fv=substr($row, 0, index($row, '|'));
    my $fd=substr($row, index($row, '|')+1, 1000);

    if(($vver =~ m/$fv/i) and (length($vver)==length($fv))){
        $fd =~ s/\$target/$target/g;
        $fd =~ s/\\n/\r\n/g;
        $fd =~ s/\|/\r\n\r\n[++] /g;
        tprint("$fd");
    }
}
close $DB;